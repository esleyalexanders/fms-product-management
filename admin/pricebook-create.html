<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Pricebook Item - Admin</title>
    <link rel="stylesheet" href="../home-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .form-container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            border-radius: 8px;
            padding: 24px;
        }

        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 6px;
            color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 15px;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-group input:disabled {
            background: #f3f4f6;
            color: #6b7280;
            cursor: not-allowed;
        }

        .price-section {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .currency-wrapper {
            flex-shrink: 0;
        }

        .currency-select {
            min-width: 80px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #fff;
            padding: 10px 12px;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 8px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 32px;
        }

        .currency-select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .price-wrapper {
            flex: 1;
        }

        .price-input {
            width: 100%;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 10px 16px;
            font-size: 15px;
        }

        .price-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .price-input::placeholder {
            color: #9ca3af;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
            margin-top: 24px;
        }

        .btn-primary,
        .btn-secondary {
            font-family: inherit;
            font-size: 15px;
            border-radius: 6px;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background: #6366f1;
            color: #fff;
        }

        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin: 24px 0 16px 0;
            color: #374151;
            padding-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
        }

        .sidebar .nav-item.manage-team-link {
            background: #eef2ff;
            color: #6366f1;
            font-weight: 600;
        }

        .image-upload-section {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            background: #f9fafb;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-upload-section:hover {
            border-color: #6366f1;
            background: #f3f4f6;
        }

        .image-upload-section img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 6px;
        }

        .file-input {
            display: none;
        }

        .info-text {
            font-size: 12px;
            color: #6b7280;
            margin-top: 4px;
        }

        .preview-section {
            background: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .preview-section h4 {
            margin: 0 0 12px 0;
            font-size: 16px;
            font-weight: 600;
        }

        .required {
            color: #dc2626;
        }

        /* Toggle Option Styles */
        .toggle-option {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            background: #fff;
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .toggle-option:hover {
            border-color: #9ca3af;
            background: #f9fafb;
        }

        .toggle-option.active {
            border-color: #6366f1;
            background: #eef2ff;
            color: #6366f1;
            font-weight: 600;
        }

        .toggle-option.active:hover {
            border-color: #4f46e5;
            background: #e0e7ff;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-store"></i>
                    <div class="logo-text-wrapper">
                        <span class="logo-text" id="storeName">My Store</span>
                    </div>
                </div>
            </div>
            <div class="sidebar-nav">
                <div class="nav-section-label">MAIN</div>
                <a href="../home.html" class="nav-item" style="text-decoration: none; color: inherit;"><i
                        class="fas fa-home"></i><span>Home</span></a>
                <a href="../quotes.html" class="nav-item" style="text-decoration: none; color: inherit;"><i
                        class="fas fa-file-contract"></i><span>Quotes</span></a>
                <a href="../tenant_schedule.html" class="nav-item" style="text-decoration: none; color: inherit;"><i
                        class="fas fa-calendar-alt"></i><span>Schedule</span></a>
                <a href="../manage-team/manage-team.html" class="nav-item"
                    style="text-decoration: none; color: inherit;"><i class="fas fa-users"></i><span>Manage
                        team</span></a>
                <a href="pricebook.html" class="nav-item" style="text-decoration: none; color: inherit;"><i
                        class="fas fa-book"></i><span>My pricebook</span></a>
                <a href="../Customer Management/customer-list.html" class="nav-item"
                    style="text-decoration: none; color: inherit;"><i
                        class="fas fa-user-friends"></i><span>Customers</span></a>
                <div class="sidebar-footer">
                    <a href="../manage-team/manage-team-roles.html" class="nav-item"
                        style="text-decoration: none; color: inherit;">
                        <i class="fas fa-shield-alt"></i>
                        <span>Manage roles</span>
                    </a>
                    <div class="nav-item">
                        <i class="fas fa-question-circle"></i>
                        <span>Get Set Up</span>
                    </div>
                    <div class="nav-item">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                </div>
        </nav>
        <!-- Main Content Area -->
        <main class="main-content">
            <header class="top-header">
                <div class="header-left">
                    <h1 class="page-title">Create Pricebook Item</h1>
                    <p class="page-subtitle">Add a new service or product to your pricebook</p>
                </div>
                <div class="header-right">
                    <a href="pricebook.html" style="text-decoration:none;"><button class="btn-secondary"><i
                                class="fas fa-arrow-left"></i> Back to Pricebook</button></a>
                </div>
            </header>
            <div class="content-wrapper">
                <div class="form-container">
                    <form id="pricebookForm">
                        <!-- Basic Information -->
                        <div class="section-title">Basic Information</div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="typeSelect">Type <span class="required">*</span></label>
                                <select id="typeSelect" required>
                                    <option value="">Select Type</option>
                                    <option value="service" selected>Service</option>
                                    <option value="product">Product</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="code">SKU/Code <span class="required">*</span></label>
                                <input type="text" id="code" placeholder="e.g., CLEAN-001, PROD-123" required>
                                <div class="info-text">Unique identifier for this item</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="name">Name <span class="required">*</span></label>
                            <input type="text" id="name" placeholder="e.g., Standard Home Cleaning" required>
                        </div>

                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea id="description" rows="3"
                                placeholder="Describe the service or product..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>Item Image</label>
                            <div class="image-upload-section" id="imageUploadArea">
                                <div id="imagePlaceholder">
                                    <i class="fas fa-image"
                                        style="font-size: 48px; color: #9ca3af; margin-bottom: 12px;"></i>
                                    <p style="color: #6b7280; margin: 0;">Click to upload image</p>
                                    <p style="font-size: 12px; color: #9ca3af; margin: 4px 0 0 0;">PNG, JPG up to 5MB
                                    </p>
                                </div>
                                <img id="previewImage" src=""
                                    style="display: none; width: 100%; max-height: 300px; border-radius: 6px; object-fit: cover;"
                                    alt="Preview">
                            </div>
                            <input type="file" id="imageInput" class="file-input" accept="image/*">
                            <div class="info-text">Optional. Display image for this item</div>
                        </div>

                        <!-- Service-Specific Fields -->
                        <div id="serviceFields" style="display: block;">
                            <div class="section-title">Service Details</div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="duration">MOQ</label>
                                    <input type="number" id="duration" placeholder="1" min="0" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label for="unit">Unit</label>
                                    <select id="unit">
                                        <option value="hour">Hour</option>
                                        <option value="each">Each</option>
                                        <option value="sqft">Square Foot</option>
                                        <option value="sqm">Square Meter</option>
                                        <option value="custom">Add Custom Unit</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group" id="serviceCustomUnitGroup" style="display: none;">
                                <label for="serviceCustomUnit">Custom Unit <span class="required">*</span></label>
                                <input type="text" id="serviceCustomUnit" placeholder="e.g., kg, liter, piece"
                                    style="text-transform: lowercase;">
                                <div class="info-text">Enter a custom unit name</div>
                            </div>

                            <div class="form-group">
                                <label>Applicable Service Types</label>
                                <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 8px;">
                                    <div class="toggle-option active" data-value="class"
                                        onclick="toggleServiceType(this)">
                                        <input type="checkbox" id="serviceType_class" value="class" checked
                                            style="display: none;">
                                        <span>Class</span>
                                    </div>
                                    <div class="toggle-option active" data-value="group"
                                        onclick="toggleServiceType(this)">
                                        <input type="checkbox" id="serviceType_group" value="group" checked
                                            style="display: none;">
                                        <span>Group</span>
                                    </div>
                                    <div class="toggle-option active" data-value="one-off"
                                        onclick="toggleServiceType(this)">
                                        <input type="checkbox" id="serviceType_oneoff" value="one-off" checked
                                            style="display: none;">
                                        <span>One-off</span>
                                    </div>
                                </div>
                                <div class="info-text">Select which learning service types can use this item</div>
                            </div>
                        </div>

                        <!-- Product-Specific Fields -->
                        <div id="productFields" style="display: none;">
                            <div class="section-title">Product Details</div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="productMOQ">MOQ</label>
                                    <input type="number" id="productMOQ" placeholder="1" min="0" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label for="productUnit">Unit</label>
                                    <select id="productUnit">
                                        <option value="each">Each</option>
                                        <option value="piece">Piece</option>
                                        <option value="box">Box</option>
                                        <option value="kg">Kg</option>
                                        <option value="lb">Lb</option>
                                        <option value="liter">Liter</option>
                                        <option value="gallon">Gallon</option>
                                        <option value="custom">Add Custom Unit</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group" id="productCustomUnitGroup" style="display: none;">
                                <label for="productCustomUnit">Custom Unit <span class="required">*</span></label>
                                <input type="text" id="productCustomUnit" placeholder="e.g., set, pair, case"
                                    style="text-transform: lowercase;">
                                <div class="info-text">Enter a custom unit name</div>
                            </div>
                        </div>

                        <!-- Pricing -->
                        <div class="section-title">Pricing</div>

                        <div class="form-group">
                            <label for="price" id="priceLabel">Price (per hour) <span class="required">*</span></label>
                            <div class="price-section">
                                <div class="currency-wrapper">
                                    <select id="currency" class="currency-select">
                                        <option value="AUD" selected>AUD</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                        <option value="GBP">GBP</option>
                                        <option value="NZD">NZD</option>
                                    </select>
                                </div>
                                <div class="price-wrapper">
                                    <input type="number" id="price" class="price-input" step="0.01" min="0"
                                        placeholder="0.00" required>
                                </div>
                            </div>
                            <div class="info-text" id="priceInfo">Price will be calculated per hour</div>
                        </div>

                        <div class="form-group">
                            <label for="tax">Tax Category (Australia) <span class="required">*</span></label>
                            <select id="tax" required>
                                <option value="">Select Tax Category</option>
                                <option value="taxable_gst">Taxable — GST applies (standard 10%)</option>
                                <option value="gst_free">GST-free — 0% (e.g., some health, basic food)</option>
                                <option value="input_taxed">Input-taxed — no GST charged but special reporting</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Supported Payment Models</label>
                            <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 8px;">
                                <div class="toggle-option active" data-value="full_payment"
                                    onclick="togglePaymentModel(this)">
                                    <input type="checkbox" id="paymentModel_full" value="full_payment" checked
                                        style="display: none;">
                                    <span>Full Payment (Upfront)</span>
                                </div>
                                <div class="toggle-option active" data-value="down_payment"
                                    onclick="togglePaymentModel(this)">
                                    <input type="checkbox" id="paymentModel_deposit" value="down_payment" checked
                                        style="display: none;">
                                    <span>Down Payment (Deposit)</span>
                                </div>
                                <div class="toggle-option active" data-value="subscription"
                                    onclick="togglePaymentModel(this)">
                                    <input type="checkbox" id="paymentModel_subscription" value="subscription" checked
                                        style="display: none;">
                                    <span>Subscription (Recurring)</span>
                                </div>
                            </div>
                            <div class="info-text">Select payment models this item can support. Subscription frequency
                                (weekly/monthly) is configured when adding to quotes.</div>
                        </div>

                        <!-- Subscription Frequency Field (conditional) -->
                        <div class="form-group" id="subscriptionFrequencyGroup" style="display: block;">
                            <label>Subscription Frequency Options <span class="required">*</span></label>
                            <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 8px;">
                                <div class="toggle-option active" data-value="weekly" onclick="toggleFrequency(this)">
                                    <input type="checkbox" id="frequency_weekly" value="weekly" checked
                                        style="display: none;">
                                    <span>Weekly</span>
                                </div>
                                <div class="toggle-option active" data-value="monthly" onclick="toggleFrequency(this)">
                                    <input type="checkbox" id="frequency_monthly" value="monthly" checked
                                        style="display: none;">
                                    <span>Monthly</span>
                                </div>
                                <div class="toggle-option active" data-value="quarterly"
                                    onclick="toggleFrequency(this)">
                                    <input type="checkbox" id="frequency_quarterly" value="quarterly" checked
                                        style="display: none;">
                                    <span>Quarterly</span>
                                </div>
                                <div class="toggle-option active" data-value="annually" onclick="toggleFrequency(this)">
                                    <input type="checkbox" id="frequency_annually" value="annually" checked
                                        style="display: none;">
                                    <span>Annually</span>
                                </div>
                            </div>
                            <div class="info-text">Select which billing frequencies are available when this item is
                                added to quotes with subscription payment</div>
                        </div>

                        <!-- Preview Section -->
                        <div class="preview-section">
                            <h4>Preview</h4>
                            <div id="previewContent">
                                <p style="color: #6b7280; margin: 0;">Start filling the form to see preview</p>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-secondary"
                                onclick="window.location.href='pricebook.html'">Cancel</button>
                            <button type="button" class="btn-secondary" id="saveDraftBtn">Save as Draft</button>
                            <button type="submit" class="btn-primary">Create Item</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Toggle functions for multi-select options
        function toggleServiceType(element) {
            element.classList.toggle('active');
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = element.classList.contains('active');
        }

        function togglePaymentModel(element) {
            element.classList.toggle('active');
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = element.classList.contains('active');

            // Show/hide subscription frequency field
            updateSubscriptionFrequencyVisibility();
        }

        function toggleFrequency(element) {
            element.classList.toggle('active');
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = element.classList.contains('active');
        }

        function updateSubscriptionFrequencyVisibility() {
            const subscriptionCheckbox = document.getElementById('paymentModel_subscription');
            const frequencyGroup = document.getElementById('subscriptionFrequencyGroup');

            if (subscriptionCheckbox && subscriptionCheckbox.checked) {
                frequencyGroup.style.display = 'block';
            } else {
                frequencyGroup.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const typeSelect = document.getElementById('typeSelect');
            const serviceFields = document.getElementById('serviceFields');
            const productFields = document.getElementById('productFields');
            const imageUploadArea = document.getElementById('imageUploadArea');
            const imageInput = document.getElementById('imageInput');
            const previewImage = document.getElementById('previewImage');
            const imagePlaceholder = document.getElementById('imagePlaceholder');
            const codeInput = document.getElementById('code');
            const nameInput = document.getElementById('name');
            const priceInput = document.getElementById('price');
            const currencySelect = document.getElementById('currency');
            const descriptionInput = document.getElementById('description');
            const previewContent = document.getElementById('previewContent');

            // Initialize subscription frequency visibility
            updateSubscriptionFrequencyVisibility();

            // Type selection toggle
            typeSelect.addEventListener('change', function () {
                const priceLabel = document.getElementById('priceLabel');
                const priceInfo = document.getElementById('priceInfo');

                if (typeSelect.value === 'service') {
                    serviceFields.style.display = 'block';
                    productFields.style.display = 'none';
                    priceLabel.innerHTML = 'Price (per hour) <span class="required">*</span>';
                    priceInfo.textContent = 'Price will be calculated per hour';
                } else if (typeSelect.value === 'product') {
                    serviceFields.style.display = 'none';
                    productFields.style.display = 'block';
                    priceLabel.innerHTML = 'Price (per unit) <span class="required">*</span>';
                    priceInfo.textContent = 'Price will be per unit';
                } else {
                    serviceFields.style.display = 'none';
                    productFields.style.display = 'none';
                    priceLabel.innerHTML = 'Price <span class="required">*</span>';
                    priceInfo.textContent = 'Enter the price';
                }
                updatePreview();
            });

            // Service unit selection (including custom)
            const unitSelect = document.getElementById('unit');
            const serviceCustomUnitGroup = document.getElementById('serviceCustomUnitGroup');
            const serviceCustomUnitInput = document.getElementById('serviceCustomUnit');

            if (unitSelect) {
                unitSelect.addEventListener('change', function () {
                    if (unitSelect.value === 'custom') {
                        serviceCustomUnitGroup.style.display = 'block';
                        serviceCustomUnitInput.required = true;
                    } else {
                        serviceCustomUnitGroup.style.display = 'none';
                        serviceCustomUnitInput.required = false;
                        serviceCustomUnitInput.value = '';
                    }
                    updatePreview();
                });
            }

            // Product unit selection (including custom)
            const productUnitSelect = document.getElementById('productUnit');
            const productCustomUnitGroup = document.getElementById('productCustomUnitGroup');
            const productCustomUnitInput = document.getElementById('productCustomUnit');

            if (productUnitSelect) {
                productUnitSelect.addEventListener('change', function () {
                    if (productUnitSelect.value === 'custom') {
                        productCustomUnitGroup.style.display = 'block';
                        productCustomUnitInput.required = true;
                    } else {
                        productCustomUnitGroup.style.display = 'none';
                        productCustomUnitInput.required = false;
                        productCustomUnitInput.value = '';
                    }
                    updatePreview();
                });
            }

            // Image upload
            imageUploadArea.addEventListener('click', function () {
                imageInput.click();
            });

            imageInput.addEventListener('change', function (e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        previewImage.src = e.target.result;
                        previewImage.style.display = 'block';
                        imagePlaceholder.style.display = 'none';
                        updatePreview();
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Update preview
            function updatePreview() {
                const name = nameInput.value || '[Item Name]';
                const code = codeInput.value || '[SKU/Code]';
                const currency = currencySelect.value;
                const price = priceInput.value ? `${Number(priceInput.value).toFixed(2)}` : '0.00';
                const displayPrice = `${currency} ${price}`;
                const description = descriptionInput.value || '[Description]';
                const type = typeSelect.value || 'item';
                const unitText = type === 'service' ? '/ hour' : type === 'product' ? '/ unit' : '';
                const imageHtml = previewImage.style.display !== 'none' ?
                    `<img src="${previewImage.src}" style="width:100%;border-radius:6px;margin-bottom:12px;max-height:200px;object-fit:cover;">` : '';

                previewContent.innerHTML = `
                    ${imageHtml}
                    <div style="padding:12px;background:#fff;border-radius:6px;">
                        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px;">
                            <div>
                                <div style="font-weight:600;font-size:16px;color:#111827;">${name}</div>
                                <div style="font-size:13px;color:#6b7280;">${code}${type ? ' • ' + (type === 'service' ? 'Service' : type === 'product' ? 'Product' : '') : ''}</div>
                            </div>
                            <div style="text-align:right;">
                                <div style="font-weight:700;color:#6366f1;font-size:20px;">${displayPrice}</div>
                                <div style="font-size:11px;color:#9ca3af;">${unitText}</div>
                            </div>
                        </div>
                        <div style="color:#6b7280;font-size:14px;line-height:1.5;">${description}</div>
                    </div>
                `;
            }

            // Add event listeners for preview updates
            nameInput.addEventListener('input', updatePreview);
            codeInput.addEventListener('input', updatePreview);
            priceInput.addEventListener('input', updatePreview);
            currencySelect.addEventListener('change', updatePreview);
            descriptionInput.addEventListener('input', updatePreview);

            // Form submission
            document.getElementById('pricebookForm').addEventListener('submit', function (e) {
                e.preventDefault();
                alert('Item created successfully! (Demo)');
                // In real implementation, send data to server
                // window.location.href = 'pricebook.html';
            });

            // Save draft
            document.getElementById('saveDraftBtn').addEventListener('click', function () {
                alert('Draft saved! (Demo)');
                // In real implementation, save to server
            });
        });
    </script>
</body>

</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoices - FMS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Sidebar Styles */
        .app-container {
            display: flex;
            min-height: 100vh;
            background: #f9fafb;
        }

        .sidebar {
            width: 240px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 40;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: #e5e7eb;
            border-radius: 3px;
        }

        .sidebar-header {
            padding: 1.5rem 1.25rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            color: #3b82f6;
        }

        .logo-text {
            font-weight: 700;
            font-size: 1.125rem;
            color: #111827;
        }

        .sidebar-nav {
            flex: 1;
            padding: 1rem 0;
        }

        .nav-section-label {
            padding: 0.5rem 1.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.25rem;
            color: #6b7280;
            text-decoration: none;
            transition: all 0.15s ease;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .nav-item:hover {
            background-color: #f3f4f6;
            color: #111827;
        }

        .nav-item.active {
            background-color: #eff6ff;
            color: #3b82f6;
            border-right: 3px solid #3b82f6;
        }

        .nav-item i {
            width: 1.25rem;
            font-size: 1.125rem;
        }

        .sidebar-footer {
            border-top: 1px solid #e5e7eb;
            padding: 1rem 0;
        }

        .main-content {
            flex: 1;
            margin-left: 240px;
            overflow-y: auto;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-store"></i>
                    <span class="logo-text">Sunshine Tutoring</span>
                </div>
            </div>

            <div class="sidebar-nav">
                <div class="nav-section-label">MAIN</div>
                <a href="../../home.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-home"></i><span>Home</span>
                </a>
                <a href="quote_list_simple.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-file-contract"></i><span>Quotes</span>
                </a>
                <a href="invoice_list_simple.html" class="nav-item active" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-file-invoice-dollar"></i><span>Invoices</span>
                </a>
                <a href="../../[v2] Jobs/job_list.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-briefcase"></i><span>Jobs</span>
                </a>
                <a href="../../tenant_schedule.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-calendar-alt"></i><span>Schedule</span>
                </a>
                <a href="../../manage-team/manage-team.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-users"></i><span>Manage team</span>
                </a>
                <a href="../../admin/pricebook.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-book"></i><span>My pricebook</span>
                </a>
                <a href="../../Customer Management/customer-list.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-user-friends"></i><span>Customers</span>
                </a>
            </div>

            <div class="sidebar-footer">
                <a href="../../manage-team/manage-team-roles.html" class="nav-item" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-shield-alt"></i>
                    <span>Manage roles</span>
                </a>
                <div class="nav-item">
                    <i class="fas fa-question-circle"></i>
                    <span>Get Set Up</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="p-4 md:p-6">
                <div class="max-w-7xl mx-auto">
            
            <!-- Header -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900">Invoices</h1>
                        <p class="text-gray-600 mt-1">Manage and track all your invoices</p>
                    </div>
                    <button 
                        onclick="window.location.href='quote_list_simple.html'"
                        class="px-4 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium flex items-center gap-2"
                    >
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Create from Quote
                    </button>
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="bg-white rounded-lg shadow-sm p-5 border-l-4 border-purple-500">
                    <div class="flex items-center justify-between mb-2">
                        <div class="text-sm font-medium text-gray-600">Total Revenue</div>
                        <div class="p-2 bg-purple-100 rounded-lg">
                            <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="text-2xl font-bold text-gray-900" id="totalRevenue">$0.00</div>
                    <div class="text-xs text-gray-500 mt-1">All time</div>
                </div>

                <div class="bg-white rounded-lg shadow-sm p-5 border-l-4 border-yellow-500">
                    <div class="flex items-center justify-between mb-2">
                        <div class="text-sm font-medium text-gray-600">Outstanding</div>
                        <div class="p-2 bg-yellow-100 rounded-lg">
                            <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="text-2xl font-bold text-gray-900" id="outstandingAmount">$0.00</div>
                    <div class="text-xs text-gray-500 mt-1"><span id="unpaidCount">0</span> unpaid invoices</div>
                </div>

                <div class="bg-white rounded-lg shadow-sm p-5 border-l-4 border-red-500">
                    <div class="flex items-center justify-between mb-2">
                        <div class="text-sm font-medium text-gray-600">Overdue</div>
                        <div class="p-2 bg-red-100 rounded-lg">
                            <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="text-2xl font-bold text-gray-900" id="overdueAmount">$0.00</div>
                    <div class="text-xs text-gray-500 mt-1"><span id="overdueCount">0</span> overdue invoices</div>
                </div>

                <div class="bg-white rounded-lg shadow-sm p-5 border-l-4 border-green-500">
                    <div class="flex items-center justify-between mb-2">
                        <div class="text-sm font-medium text-gray-600">Paid This Month</div>
                        <div class="p-2 bg-green-100 rounded-lg">
                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="text-2xl font-bold text-gray-900" id="paidThisMonth">$0.00</div>
                    <div class="text-xs text-gray-500 mt-1"><span id="paidCount">0</span> invoices</div>
                </div>
            </div>

            <!-- Filters -->
            <div class="bg-white rounded-lg shadow-sm p-4 mb-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="md:col-span-2">
                        <div class="relative">
                            <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                            <input 
                                type="text" 
                                id="searchInput"
                                placeholder="Search invoices..."
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                    </div>
                    <select class="px-3 py-2 border border-gray-300 rounded-lg">
                        <option>All Payment Models</option>
                        <option>Full Payment</option>
                        <option>Deposit</option>
                        <option>Subscription</option>
                    </select>
                    <select class="px-3 py-2 border border-gray-300 rounded-lg">
                        <option>Newest First</option>
                        <option>Oldest First</option>
                        <option>Highest Amount</option>
                        <option>Due Date</option>
                    </select>
                </div>
            </div>

            <!-- Status Tabs -->
            <div class="bg-white rounded-lg shadow-sm mb-4">
                <div class="border-b border-gray-200 overflow-x-auto">
                    <div class="flex">
                        <button class="tab-button active" data-status="all" onclick="filterByStatus('all')">
                            All Invoices
                            <span class="tab-badge" id="allCount">0</span>
                        </button>
                        <button class="tab-button" data-status="unpaid" onclick="filterByStatus('unpaid')">
                            Unpaid
                            <span class="tab-badge" id="unpaidTabCount">0</span>
                        </button>
                        <button class="tab-button" data-status="partially_paid" onclick="filterByStatus('partially_paid')">
                            Partially Paid
                            <span class="tab-badge" id="partiallyPaidCount">0</span>
                        </button>
                        <button class="tab-button" data-status="paid" onclick="filterByStatus('paid')">
                            Paid
                            <span class="tab-badge" id="paidTabCount">0</span>
                        </button>
                        <button class="tab-button" data-status="overdue" onclick="filterByStatus('overdue')">
                            Overdue
                            <span class="tab-badge" id="overdueTabCount">0</span>
                        </button>
                        <button class="tab-button" data-status="cancelled" onclick="filterByStatus('cancelled')">
                            Cancelled
                            <span class="tab-badge" id="cancelledCount">0</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Invoice List -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                <div id="invoicesContainer">
                    <!-- Invoices will be populated here -->
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="hidden text-center py-12">
                    <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">No invoices found</h3>
                    <p class="text-gray-600 mb-4">Create your first invoice from a quote</p>
                    <button 
                        onclick="window.location.href='quote_list_simple.html'"
                        class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"
                    >
                        Go to Quotes
                    </button>
                </div>
            </div>

            <!-- Pagination -->
            <div class="mt-4 flex items-center justify-between">
                <div class="text-sm text-gray-600">
                    Showing <span id="showingFrom">1</span> to <span id="showingTo">10</span> of <span id="totalInvoices">0</span> invoices
                </div>
                <div class="flex gap-2">
                    <button 
                        id="prevBtn"
                        onclick="changePage(-1)"
                        class="px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled
                    >
                        Previous
                    </button>
                    <button 
                        id="nextBtn"
                        onclick="changePage(1)"
                        class="px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        Next
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        .tab-button {
            position: relative;
            padding: 0.75rem 1.25rem;
            font-weight: 500;
            color: #6b7280;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            cursor: pointer;
            background: transparent;
            border: none;
        }
        
        .tab-button:hover {
            color: #374151;
            background: #f9fafb;
        }
        
        .tab-button.active {
            color: #7c3aed;
            border-bottom-color: #7c3aed;
            background: #faf5ff;
        }

        .tab-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 1.5rem;
            height: 1.5rem;
            padding: 0 0.5rem;
            margin-left: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
            background: #e5e7eb;
            color: #374151;
        }

        .tab-button.active .tab-badge {
            background: #7c3aed;
            color: white;
        }

        .invoice-card {
            border-bottom: 1px solid #f3f4f6;
            padding: 1.25rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .invoice-card:hover {
            background: #fafafa;
        }

        .invoice-card:last-child {
            border-bottom: none;
        }
    </style>

    <script>
        // Mock invoice data
        const invoices = [
            {
                id: 'INV-2024-001',
                quoteId: 'Q-2024-001',
                customerName: 'Alice Anderson',
                customerEmail: 'alice.a@email.com',
                invoiceDate: '2024-11-01',
                dueDate: '2024-12-01',
                amount: 341.00,
                paidAmount: 0,
                status: 'unpaid',
                paymentModel: 'full',
                paymentMethods: ['stripe', 'paypal'],
                items: 2
            },
            {
                id: 'INV-2024-002',
                quoteId: 'Q-2024-002',
                customerName: 'Bob Brown',
                customerEmail: 'bob.b@email.com',
                invoiceDate: '2024-11-02',
                dueDate: '2024-11-16',
                amount: 500.00,
                paidAmount: 250.00,
                status: 'partially_paid',
                paymentModel: 'deposit',
                paymentMethods: ['stripe', 'cash'],
                items: 3,
                depositAmount: 250.00,
                remainingBalance: 250.00
            },
            {
                id: 'INV-2024-003',
                quoteId: 'Q-2024-003',
                customerName: 'Carol Chen',
                customerEmail: 'carol.c@email.com',
                invoiceDate: '2024-10-15',
                dueDate: '2024-10-30',
                amount: 750.00,
                paidAmount: 0,
                status: 'overdue',
                paymentModel: 'full',
                paymentMethods: ['paypal', 'cash'],
                items: 4
            },
            {
                id: 'INV-2024-004',
                quoteId: 'Q-2024-004',
                customerName: 'David Davis',
                customerEmail: 'david.d@email.com',
                invoiceDate: '2024-11-05',
                dueDate: '2024-12-05',
                amount: 299.00,
                paidAmount: 299.00,
                status: 'paid',
                paymentModel: 'subscription',
                paymentMethods: ['stripe'],
                items: 1,
                paidDate: '2024-11-05'
            },
            {
                id: 'INV-2024-005',
                quoteId: 'Q-2024-005',
                customerName: 'Emma Evans',
                customerEmail: 'emma.e@email.com',
                invoiceDate: '2024-11-08',
                dueDate: '2024-12-08',
                amount: 1200.00,
                paidAmount: 600.00,
                status: 'partially_paid',
                paymentModel: 'deposit',
                paymentMethods: ['stripe', 'paypal'],
                items: 5,
                depositAmount: 600.00,
                remainingBalance: 600.00
            },
            {
                id: 'INV-2024-006',
                quoteId: 'Q-2024-006',
                customerName: 'Frank Foster',
                customerEmail: 'frank.f@email.com',
                invoiceDate: '2024-10-20',
                dueDate: '2024-11-05',
                amount: 450.00,
                paidAmount: 0,
                status: 'overdue',
                paymentModel: 'full',
                paymentMethods: ['cash'],
                items: 2
            },
            {
                id: 'INV-2024-007',
                quoteId: 'Q-2024-007',
                customerName: 'Grace Green',
                customerEmail: 'grace.g@email.com',
                invoiceDate: '2024-11-10',
                dueDate: '2024-12-10',
                amount: 899.00,
                paidAmount: 899.00,
                status: 'paid',
                paymentModel: 'full',
                paymentMethods: ['stripe', 'paypal'],
                items: 3,
                paidDate: '2024-11-10'
            },
            {
                id: 'INV-2024-008',
                quoteId: 'Q-2024-008',
                customerName: 'Henry Hill',
                customerEmail: 'henry.h@email.com',
                invoiceDate: '2024-11-09',
                dueDate: '2024-12-09',
                amount: 199.00,
                paidAmount: 0,
                status: 'unpaid',
                paymentModel: 'subscription',
                paymentMethods: ['stripe', 'paypal'],
                items: 1
            },
            {
                id: 'INV-2024-009',
                quoteId: 'Q-2024-009',
                customerName: 'Ivy Irwin',
                customerEmail: 'ivy.i@email.com',
                invoiceDate: '2024-11-07',
                dueDate: '2024-12-07',
                amount: 650.00,
                paidAmount: 650.00,
                status: 'paid',
                paymentModel: 'full',
                paymentMethods: ['stripe'],
                items: 2,
                paidDate: '2024-11-08'
            },
            {
                id: 'INV-2024-010',
                quoteId: 'Q-2024-010',
                customerName: 'Jack Johnson',
                customerEmail: 'jack.j@email.com',
                invoiceDate: '2024-10-25',
                dueDate: '2024-11-10',
                amount: 380.00,
                paidAmount: 0,
                status: 'overdue',
                paymentModel: 'full',
                paymentMethods: ['paypal', 'cash'],
                items: 3
            }
        ];

        let currentPage = 1;
        const itemsPerPage = 10;
        let filteredInvoices = [...invoices];
        let currentStatusFilter = 'all';

        // Payment method configuration
        const paymentMethodConfig = {
            stripe: { name: 'Stripe', color: 'purple' },
            paypal: { name: 'PayPal', color: 'blue' },
            google_wallet: { name: 'Google Wallet', color: 'green' },
            apple_pay: { name: 'Apple Pay', color: 'gray' },
            cash: { name: 'Cash', color: 'yellow' }
        };

        // Initialize page
        function initializePage() {
            updateKPIs();
            updateTabCounts();
            renderInvoices();
        }

        // Update KPI cards
        function updateKPIs() {
            const totalRevenue = invoices.reduce((sum, inv) => sum + inv.paidAmount, 0);
            const outstanding = invoices
                .filter(inv => inv.status === 'unpaid' || inv.status === 'partially_paid')
                .reduce((sum, inv) => sum + (inv.amount - inv.paidAmount), 0);
            const overdue = invoices
                .filter(inv => inv.status === 'overdue')
                .reduce((sum, inv) => sum + (inv.amount - inv.paidAmount), 0);
            
            const currentMonth = new Date().getMonth();
            const paidThisMonth = invoices
                .filter(inv => inv.paidDate && new Date(inv.paidDate).getMonth() === currentMonth)
                .reduce((sum, inv) => sum + inv.paidAmount, 0);

            document.getElementById('totalRevenue').textContent = `$${totalRevenue.toFixed(2)}`;
            document.getElementById('outstandingAmount').textContent = `$${outstanding.toFixed(2)}`;
            document.getElementById('overdueAmount').textContent = `$${overdue.toFixed(2)}`;
            document.getElementById('paidThisMonth').textContent = `$${paidThisMonth.toFixed(2)}`;

            document.getElementById('unpaidCount').textContent = invoices.filter(inv => inv.status === 'unpaid').length;
            document.getElementById('overdueCount').textContent = invoices.filter(inv => inv.status === 'overdue').length;
            document.getElementById('paidCount').textContent = invoices.filter(inv => inv.paidDate && new Date(inv.paidDate).getMonth() === currentMonth).length;
        }

        // Update tab counts
        function updateTabCounts() {
            document.getElementById('allCount').textContent = invoices.length;
            document.getElementById('unpaidTabCount').textContent = invoices.filter(inv => inv.status === 'unpaid').length;
            document.getElementById('partiallyPaidCount').textContent = invoices.filter(inv => inv.status === 'partially_paid').length;
            document.getElementById('paidTabCount').textContent = invoices.filter(inv => inv.status === 'paid').length;
            document.getElementById('overdueTabCount').textContent = invoices.filter(inv => inv.status === 'overdue').length;
            document.getElementById('cancelledCount').textContent = invoices.filter(inv => inv.status === 'cancelled').length;
        }

        // Get status badge HTML
        function getStatusBadge(status) {
            const badges = {
                unpaid: '<span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700">Unpaid</span>',
                partially_paid: '<span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700">Partially Paid</span>',
                paid: '<span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700">Paid</span>',
                overdue: '<span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700">Overdue</span>',
                cancelled: '<span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700">Cancelled</span>'
            };
            return badges[status] || '';
        }

        // Get payment model badge
        function getPaymentModelBadge(model) {
            const badges = {
                full: '<span class="text-xs px-2 py-1 bg-purple-50 text-purple-700 rounded">Full Payment</span>',
                deposit: '<span class="text-xs px-2 py-1 bg-orange-50 text-orange-700 rounded">Deposit</span>',
                subscription: '<span class="text-xs px-2 py-1 bg-green-50 text-green-700 rounded">Subscription</span>'
            };
            return badges[model] || '';
        }

        // Get payment methods HTML
        function getPaymentMethodsHTML(methods) {
            return methods.map(method => {
                const config = paymentMethodConfig[method];
                if (!config) return '';
                return `<span class="inline-flex items-center gap-1 px-2 py-0.5 bg-${config.color}-50 text-${config.color}-700 rounded text-xs">${config.name}</span>`;
            }).join('');
        }

        // Render invoices
        function renderInvoices() {
            const container = document.getElementById('invoicesContainer');
            const emptyState = document.getElementById('emptyState');

            if (filteredInvoices.length === 0) {
                container.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredInvoices.length);
            const pageInvoices = filteredInvoices.slice(startIndex, endIndex);

            container.innerHTML = pageInvoices.map(invoice => `
                <div class="invoice-card" onclick="viewInvoice('${invoice.id}')">
                    <div class="flex items-start justify-between gap-4">
                        <!-- Left: Invoice Info -->
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center gap-3 mb-2">
                                <h3 class="text-lg font-semibold text-gray-900">${invoice.id}</h3>
                                ${getStatusBadge(invoice.status)}
                                ${getPaymentModelBadge(invoice.paymentModel)}
                            </div>
                            <div class="flex items-center gap-4 text-sm text-gray-600 mb-2">
                                <div class="flex items-center gap-1">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                    <span class="font-medium">${invoice.customerName}</span>
                                </div>
                                <span class="text-gray-400">•</span>
                                <div class="flex items-center gap-1">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    <span>${invoice.items} item${invoice.items > 1 ? 's' : ''}</span>
                                </div>
                                <span class="text-gray-400">•</span>
                                <span>From ${invoice.quoteId}</span>
                            </div>
                            <div class="flex items-center gap-2 flex-wrap">
                                ${getPaymentMethodsHTML(invoice.paymentMethods)}
                            </div>
                        </div>

                        <!-- Right: Amount & Dates -->
                        <div class="text-right">
                            <div class="text-2xl font-bold text-purple-600 mb-1">$${invoice.amount.toFixed(2)}</div>
                            ${invoice.paidAmount > 0 && invoice.status !== 'paid' ? 
                                `<div class="text-sm text-gray-600 mb-2">Paid: $${invoice.paidAmount.toFixed(2)}</div>` : ''}
                            <div class="text-xs text-gray-500">
                                <div>Due: ${new Date(invoice.dueDate).toLocaleDateString()}</div>
                                ${invoice.status === 'overdue' ? 
                                    `<div class="text-red-600 font-medium mt-1">⚠️ Overdue</div>` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            updatePagination();
        }

        // Update pagination
        function updatePagination() {
            const total = filteredInvoices.length;
            const start = (currentPage - 1) * itemsPerPage + 1;
            const end = Math.min(start + itemsPerPage - 1, total);

            document.getElementById('showingFrom').textContent = start;
            document.getElementById('showingTo').textContent = end;
            document.getElementById('totalInvoices').textContent = total;

            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = end >= total;
        }

        // Filter by status
        function filterByStatus(status) {
            currentStatusFilter = status;
            
            // Update active tab
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.status === status) {
                    btn.classList.add('active');
                }
            });

            // Filter invoices
            if (status === 'all') {
                filteredInvoices = [...invoices];
            } else {
                filteredInvoices = invoices.filter(inv => inv.status === status);
            }

            currentPage = 1;
            renderInvoices();
        }

        // Change page
        function changePage(direction) {
            const maxPage = Math.ceil(filteredInvoices.length / itemsPerPage);
            currentPage += direction;
            
            if (currentPage < 1) currentPage = 1;
            if (currentPage > maxPage) currentPage = maxPage;
            
            renderInvoices();
        }

        // View invoice
        function viewInvoice(invoiceId) {
            window.location.href = `invoice_detail_simple.html?id=${invoiceId}`;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
                </div>
            </div>
        </main>
    </div>
</body>
</html>
